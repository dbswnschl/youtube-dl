{% extends "base.html" %}
{% block content %}

<div>
	{{ macros.setting_input_text('url', 'URL', placeholder='http:// 주소', desc='유튜브, 네이버TV 등 동영상 주소') }}
	{{ macros.setting_input_text('filename', '파일명', value=arg['file_name'], desc='템플릿 규칙은 https://github.com/ytdl-org/youtube-dl/blob/master/README.md#output-template 참고') }}
	{{ macros.setting_select('preset', '동영상 포맷 프리셋', arg['preset_list'], col='3') }}
	{{ macros.setting_input_text('format', '동영상 포맷', desc=['포맷 지정은 https://github.com/ytdl-org/youtube-dl/blob/master/README.md#format-selection 참고', '빈칸으로 두면 최고 화질로 다운로드합니다.']) }}
	<!-- {{ macros.setting_select('merge_output_format', '파일 포맷', [['auto', '자동'], ['mkv', 'mkv'], ['mp4', 'mp4'], ['ogg', 'ogg'], ['webm', 'webm'], ['flv', 'flv']], col='3', value=arg['merge_output_format'], desc='병합이 필요한 경우 지정한 포맷으로 병합을 합니다.') }} -->
	{{ macros.setting_button([['download_start', '다운로드']]) }}
</div>

<script>
	"use strict";
	var package_name = '{{ arg["package_name"] }}';

	$(function () {
		// 프리셋 변경
		$('#preset').change(function (e) {
			if ($(this).val() == '_custom') {
				return;
			}
			$('#format').val($(this).val());
		});
		$('#format').change(function (e) {
			$('#preset').val('_custom');
		});

		// 다운로드
		$('#download_start').click(function (e) {
			if ($('#url').val().startsWith('http') == false) {
				$.notify('<strong>URL을 입력하세요.</strong>', {
					type: 'warning'
				});
				return;
			}
			$.ajax({
				url: '/' + package_name + '/ajax/download',
				type: 'POST',
				cache: false,
				data: {
					url: $('#url').val(),
					filename: $('#filename').val(),
					format: $('#format').val()
				},
				dataType: 'json',
				success: function (data) {
					$.notify('<strong>분석중..</strong>', {
						type: 'info'
					});
				}
			});
			return false;
		});
	});
</script>

{% endblock %}